<div class="max-w-7xl mx-auto py-10 px-4">
  <div class="bg-white shadow-xl rounded-2xl overflow-hidden">
    <!-- CabeÃ§alho -->
    <div class="px-6 py-5 border-b border-gray-200 flex justify-between items-center">
      <h1 class="text-xl font-semibold text-indigo-600 flex items-center">
        <i class="fas fa-box-open mr-2 text-gray-500"></i> Mesa <%= @table.number %>
      </h1>
      <div class="flex space-x-2">
        <%= link_to edit_table_path(@table),
          class: 'text-sm px-4 py-2 border border-indigo-500 text-indigo-600 rounded hover:bg-indigo-50 transition' ,
          title: 'Editar Mesao' do %>
          <i class="fas fa-edit mr-1"></i> Editar
          <% end %>
            <%= link_to tables_path,
              class: 'text-sm px-4 py-2 border border-gray-400 text-gray-700 rounded hover:bg-gray-100 transition' ,
              title: 'Voltar para a lista de mesas' do %>
              <i class="fas fa-arrow-left mr-1"></i> Voltar
              <% end %>
      </div>
    </div>

    <!-- ConteÃºdo principal -->
    <div class="px-6 py-8 grid grid-cols-1 md:grid-cols-2 gap-8">
  <!-- InformaÃ§Ãµes da Mesa -->
  <div>
    <% current_order = @table.orders.find_by(is_finished: false) %>

    <% if current_order.nil? %>
      <%= button_to "Novo Pedido", 
              orders_path(table_id: @table.id), 
              method: :post,
              class: 'text-sm px-4 py-2 border border-indigo-500 text-indigo-600 rounded hover:bg-indigo-50 transition' %>
    <% else %>
      <h2 class="text-gray-600 text-lg mb-3">ðŸ“‹ Pedido na mesa</h2>
      <div>
        <div>
          <%= link_to avaliable_lots_path(order_id: @order.id),
              class: 'text-sm px-4 py-2 border border-indigo-500 text-indigo-600 rounded hover:bg-indigo-50 transition',
              title: 'Adicionar Produto' do %>
            <i class="fas fa-edit mr-1"></i> Adicionar Produto
          <% end %>
        </div>
        <div class='mt-3'>
          <%= link_to order_path(@order), 
                    class: "text-sm px-4 py-2 border border-indigo-500 text-indigo-600 rounded hover:bg-indigo-50 transition inline-flex items-center" do %>
            <i class="fas fa-file-invoice-dollar mr-1"></i> Ver Pedido
          <% end %>
          
          <%= button_to close_order_order_path(@order),
                  method: :post,
                  form_class: "inline ml-2",
                  class: "text-sm px-4 py-2 border border-red-500 text-red-600 rounded hover:bg-red-50 transition inline-flex items-center",
                  data: { confirm: "Tem certeza que deseja fechar este pedido?" } do %>
            <i class="fas fa-check-circle mr-1"></i> Fechar Pedido
          <% end %>
        </div>

      
      <% order_lots = @order.order_lots %>

      <ul class="space-y-4"> <!-- Um embaixo do outro -->
        <% order_lots.each do |order_lot| %>
          <li class="bg-white rounded-xl shadow hover:shadow-lg transition duration-200 p-5 flex justify-between items-center">
            <div>
              <h2 class="text-lg font-semibold text-gray-700">
                <%= order_lot.lot.product.name %> â€” <%= order_lot.quantity %> und. â€” entregue: <%= order_lot.is_delivered ? "Sim" : "NÃ£o" %>
              </h2>
            </div>
            <div>
              <%= button_to order_lot_delivered_order_orders_lot_path(@order, order_lot),
                  method: :post,
                  form_class: "inline",
                  class: "text-sm px-4 py-2 border border-indigo-500 text-indigo-600 rounded hover:bg-red-50 transition" do %>
                <i class="fas fa-trash-alt mr-1"></i> Status
              <% end %>
            </div>
            <div>
              <%= button_to order_orders_lot_path(@order, order_lot),
                  method: :delete,
                  form_class: "inline",
                  class: "text-sm px-4 py-2 border border-red-500 text-red-600 rounded hover:bg-red-50 transition",
                  data: { confirm: "Tem certeza que deseja remover este item?" } do %>
                <i class="fas fa-trash-alt mr-1"></i> Remover
              <% end %>
            </div>
          </li>
        <% end %>
      </ul>

      </div>
      <hr class="border-t border-gray-200 my-6">
    <% end %>
  </div>
</div>
