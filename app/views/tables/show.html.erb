<%= render 'shared/alert' %>

<div class="max-w-7xl mx-auto py-10 px-4">
  <div class="bg-white shadow-xl rounded-2xl overflow-hidden">
    
    <!-- Cabeçalho -->
    <div class="px-6 py-5 border-b border-gray-200 flex justify-between items-center">
      <h1 class="text-2xl font-semibold text-gray-800 flex items-center gap-2">
        Mesa <%= @table.number %>
      </h1>
      <div class="flex flex-wrap gap-2">
        <% if @current_user.is_admin %>
          <%= link_to "Editar", edit_table_path(@table),
            class: 'text-sm px-4 py-2 border border-indigo-500 text-indigo-600 rounded hover:bg-indigo-600 hover:text-white transition', 
            title: 'Editar Mesa' %>

          <%= button_to "Remover", table_path(@table),
            method: :delete,
            form_class: "inline",
            class: 'text-sm px-4 py-2 border border-red-500 text-red-600 rounded hover:bg-red-600 hover:text-white transition', 
            data: { confirm: "Tem certeza que deseja remover essa mesa?" } %>
        <% end %>

        <%= link_to "Voltar", tables_path,
          class: 'text-sm px-4 py-2 border border-gray-400 text-gray-700 rounded hover:bg-gray-700 hover:border-gray-700 hover:text-white transition', 
          title: 'Voltar para a lista de mesas' %>
      </div>
    </div>

    <div class="px-6 py-8">
      <div>
        <% current_order = @table.open_order %>

        <% if current_order.nil? %>
          <div class="flex justify-between items-center mb-5">
            <h2 class="text-gray-700 text-xl font-medium mb-4">Nenhum pedido na mesa</h2>

            <%= button_to "Novo Pedido",
                  orders_path(table_id: @table.id),
                  method: :post,
                  class: 'inline-flex items-center px-5 py-2.5 rounded-xl text-sm font-semibold text-white bg-[#c2410c] hover:bg-[#9a3412] transition' %> 
          </div>
          <p class="text-sm text-gray-600 mb-2">
            Esta mesa ainda não possui um pedido ativo. Clique no botão "Novo Pedido" para iniciar um novo pedido.
        <% else %>
          <div>
            <div class="flex justify-between items-center mb-5">
              <h2 class="text-gray-700 text-xl font-medium mb-4">Pedido Atual</h2>
              <%= link_to "Ver Pedido", order_path(current_order),
                class: 'inline-flex items-center px-5 py-2.5 rounded-xl text-sm font-semibold text-white bg-[#c2410c] hover:bg-[#9a3412] transition' %> 
            </div>          
            <p class="text-sm text-gray-600 mb-2">
              <strong>Status:</strong> <span class="text-red-600">Em andamento</span><br>
              <strong>Total:</strong> R$ <%= number_to_currency(current_order.total_price, unit: "", separator: ",", delimiter: ".") %>
            </p>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
♀